#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/personality.h>


// Take a look at printftoy3_internals, that is what you are actually exploiting.
#define TARGET "./printftoy3_internals"

int main(int argc, char* argv[])
{
  // This is similar to the setup for the sploits. We're disabling
  // ASLR to make things more dependable.
  /* Setup code to make sure your target runs without ASLR */
  personality(ADDR_NO_RANDOMIZE);

  char *args[3];
  char *env[1];

  args[0] = TARGET;
  args[1] = argv[1];
  args[2] = argv[2];
  args[3] = NULL;
  env[0] = NULL;

  if(argc < 3){
    printf("%s expects 2 arguments, make sure to supply them!\n", TARGET);
    exit(-1);
  }
  if (0 > execve(TARGET, args, env))
    perror("execve failed");
  return 0;
}
