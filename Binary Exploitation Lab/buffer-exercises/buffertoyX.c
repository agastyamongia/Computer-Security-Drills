#include <string.h>
#include <stdio.h>
#include <stdint.h>
#include <stddef.h>
#include <unistd.h>

void func(char* str){
  unsigned int is_user_admin = 0;
  unsigned int im_guarding_the_admin_flag = 872428596;
  char destination_buffer[32];

  /*
   * Why can't this one be solved in the same way as toy1 and toy2?
   * (Why might target7 be solvable if this one isn't....)
   * (This buffertoyX is a just for fun bonus, and may not even be solvable!
   *   Have a solution? Let David know :) )
   */

  // A dangerous strcpy!
  strcpy(destination_buffer, str);

  // An extra check... huh
  if(im_guarding_the_admin_flag != 872428596){
    printf("Hey! That value (%u) isn't right!\n"
           "Someone is attacking the program!\n",im_guarding_the_admin_flag);
    _exit(-1);
  }

  // Check if the user is admin
  if(is_user_admin == 0){
    printf("The user is NOT admin.\n");
  }
  else if(is_user_admin == 120){
    printf("The user is an admin! Congrats!\n");
  }
  else{
    printf("The user admin flag (is_user_admin = %u) is corrupted.\n",is_user_admin);
  }
}


int main(int argc, char* argv[]){
  // Pass the first argument to the program to func
  if(argc != 2){
    printf("Usage: %s input-string\n", argv[0]);
    return -1;
  }

  func(argv[1]);

}
